---
title: "Homework 5"
author: "Andrew VanDyk"
date: "2023-12-11"
categories: [news, code, analysis]
image: "image.jpg"
---

This is a post with executable code.

```{r}
1 + 1
Q2a.
# 
NFL2022_stuffs <- na.omit(NFL2022_stuffs)

Q2b.
library(dplyr)

# 
result <- NFL2022_stuffs %>%
  filter(wp > 0.2 & wp < 0.75, down <= 2, half_seconds_remaining > 120) %>%
  group_by(posteam) %>%
  summarize(mean_pass = mean(pass, na.rm = TRUE))

# 
print(result)

Q2c.
library(ggplot2)

# 
result$posteam <- factor(result$posteam, levels = result$posteam[order(result$mean_pass)])

# 
ggplot(result, aes(x = posteam, y = mean_pass)) +
  geom_point() +
  labs(title = "Mean Value of Pass for Each posteam",
       x = "posteam",
       y = "Mean Pass Value") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for better visibility

Q2d.
# 
NFL2022_stuffs_EPA <- merge(NFL2022_stuffs, NFL2022_epa[, c("game_id", "passer", "receiver", "epa")], by = "game_id", all.x = TRUE)

# 
NFL2022_stuffs_EPA <- na.omit(NFL2022_stuffs_EPA, cols = "passer")

Q2e.
library(ggplot2)

# 
filtered_data <- NFL2022_stuffs_EPA %>%
  filter(passer %in% c("J.Allen", "P.Mahomes"))

#
ggplot(filtered_data, aes(x = week, y = epa, color = passer)) +
  geom_line() +
  labs(title = "NFL Weekly Trend of Mean EPA for J.Allen and P.Mahomes",
       x = "Week",
       y = "Mean EPA") +
  scale_color_manual(values = c("J.Allen" = "blue", "P.Mahomes" = "red")) +
  theme_minimal()

# This code creates a line plot using geom_line() to visualize the weekly trend of the mean EPA for the passers "J.Allen" and "P.Mahomes." Adjust the variable names and column names based on your actual data. The scale_color_manual() function is used to assign specific colors to each passer for better visibility. The comment describes the purpose of the plot, which is to show the weekly trend of the mean EPA for the specified passers.

Q2f.
# 
library(dplyr)

#
filtered_data <- NFL2022_stuffs_EPA %>%
  filter(passer %in% c("J.Allen", "P.Mahomes"))

# 
mean_epa <- filtered_data %>%
  group_by(passer, week) %>%
  summarize(mean_epa = mean(epa, na.rm = TRUE))

# 
mean_epa_wide <- pivot_wider(mean_epa, names_from = passer, values_from = mean_epa)

# 
mean_epa_wide$epa_difference <- mean_epa_wide$J.Allen - mean_epa_wide$P.Mahomes

# 
print(mean_epa_wide)

Q2g.
# 
library(dplyr)

# 
summary_data <- mean_epa_wide %>%
  group_by(posteam, passer) %>%
  summarize(mean_epa = mean(mean_epa, na.rm = TRUE),
            n_pass = n())

# 
third_quantile_n_pass <- quantile(summary_data$n_pass, 0.75)

# 
top_passers <- summary_data %>%
  filter(n_pass >= third_quantile_n_pass) %>%
  top_n(10, wt = mean_epa)

# 
print(top_passers)


```
